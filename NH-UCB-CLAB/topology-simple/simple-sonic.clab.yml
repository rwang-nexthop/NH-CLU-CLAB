name: simple-sonic

topology:
  nodes:
    # SONiC switches
    sonic1:
      kind: sonic-vs
      image: docker-sonic-vs:latest
      type: ""

    sonic2:
      kind: sonic-vs
      image: docker-sonic-vs:latest
      type: ""

    # Host containers
    host1:
      kind: linux
      image: ghcr.io/srl-labs/alpine:latest
      exec:
        - sh -c "ip addr add 192.168.1.10/24 dev eth1 || true"
        - sh -c "ip route del default via 172.20.20.1 dev eth0 || true"
        - sh -c "ip route add default via 192.168.1.1 dev eth1 || true"

    host2:
      kind: linux
      image: ghcr.io/srl-labs/alpine:latest
      exec:
        - sh -c "ip addr add 192.168.2.10/24 dev eth1 || true"
        - sh -c "ip route del default via 172.20.20.1 dev eth0 || true"
        - sh -c "ip route add default via 192.168.2.1 dev eth1 || true"

  links:
    # SONiC to SONiC connection
    - endpoints: ["sonic1:eth1", "sonic2:eth1"]

    # Host1 connection (to sonic1 only)
    - endpoints: ["sonic1:eth2", "host1:eth1"]

    # Host2 connection (to sonic2 only)
    - endpoints: ["sonic2:eth2", "host2:eth1"]

